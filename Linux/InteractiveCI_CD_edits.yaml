title: Interactive CI/CD Pipeline Configuration Changes
id: d56ff572-fc3d-4b1c-9872-9bc39ecc0796
status: experimental
description: |
    Detects unauthorized interactive modifications to CI/CD pipeline configurations that could
    indicate supply chain attacks or malicious code injection attempts.
logsource:
    product: linux
    category: file_event
detection:
    selection_pipeline_configs:
        TargetFilename|contains:
            - '.gitlab-ci.yml'
            - '.github/workflows/'
            - 'Jenkinsfile'
            - 'azure-pipelines.yml'
            - '.travis.yml'
            - 'buildspec.yml'   # AWS CodeBuild
        EventType: 'FileCreate'
    selection_suspicious_changes:
        TargetFilename|contains:
            - '.github/workflows/'
        TargetFilename|endswith: '.yml'
    filter_legitimate:
        Image|startswith:
            - '/usr/bin/git'
            - '/opt/git'
        User|contains:
            - 'jenkins'
            - 'github-actions'
            - 'gitlab-runner'
    condition: selection_pipeline_configs and not filter_legitimate
falsepositives:
    - Emergency changes by DevOps admins (should have a PR or CHange Management if force push is used)
level: high
