title: AI Agent Command Injection Attempts
id: 4dc1a1be-f7e7-4ebd-a560-a7db0bcae481
status: experimental
description: |
    Detects potential command injection attacks against AI agents through
    suspicious prompt patterns or system command execution by AI processes.
logsource:
    product: linux
    category: process_creation
detection:
    selection_ai_processes:
        ParentImage|contains:
            - 'langchain'
            - 'openai'
            - 'anthropic'
            - 'claude'
            - 'deepseek'
            - 'llama'
            - 'ollama'
            - 'openclaw'
            - 'clawdbot'
    selection_dangerous_commands:
        CommandLine|contains:
            - '&& curl'
            - '| bash'
            - '; wget'
            - '`cat'
            - '$(cat'
            - '; nc'
    condition: selection_ai_processes and selection_dangerous_commands
level: high
falsepositives:
  - Legitimate AI agent development or debugging activities that involve
    executing shell commands in a sandbox environment.
  - System administrators or developers intentionally running commands
    containing the specified patterns within an AI agent's environment.
